<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ميزانتي - برنامج المحاسبة الشخصي</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- الرأس -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-balance-scale"></i>
                <h1>ميزانتي</h1>
                <span class="subtitle">برنامج المحاسبة الشخصي المتكامل</span>
            </div>
            <div class="user-info">
                <div class="balance-summary">
                    <div class="balance-item income">
                        <span>الإيرادات</span>
                        <span id="total-income">0 ج.م</span>
                    </div>
                    <div class="balance-item expense">
                        <span>المصروفات</span>
                        <span id="total-expense">0 ج.م</span>
                    </div>
                    <div class="balance-item net">
                        <span>الرصيد</span>
                        <span id="net-balance">0 ج.م</span>
                    </div>
                </div>
                <div class="date-display">
                    <span id="current-date"></span>
                    <button class="btn btn-primary" id="add-transaction-btn">
                        <i class="fas fa-plus"></i> إضافة معاملة
                    </button>
                </div>
            </div>
        </header>

        <!-- التنقل -->
        <nav class="tabs">
            <button class="tab-btn active" data-tab="dashboard">
                <i class="fas fa-home"></i> لوحة التحكم
            </button>
            <button class="tab-btn" data-tab="transactions">
                <i class="fas fa-exchange-alt"></i> المعاملات
            </button>
            <button class="tab-btn" data-tab="budget">
                <i class="fas fa-wallet"></i> الميزانية
            </button>
            <button class="tab-btn" data-tab="debts">
                <i class="fas fa-hand-holding-usd"></i> الديون والاقساط
            </button>
            <button class="tab-btn" data-tab="goals">
                <i class="fas fa-bullseye"></i> الأهداف
            </button>
            <button class="tab-btn" data-tab="investments">
                <i class="fas fa-chart-line"></i> الاستثمارات
            </button>
            <button class="tab-btn" data-tab="reports">
                <i class="fas fa-chart-pie"></i> التقارير
            </button>
        </nav>

        <!-- المحتوى الرئيسي -->
        <main class="main-content">
            <!-- لوحة التحكم -->
            <section id="dashboard" class="tab-content active">
                <div class="dashboard-grid">
                    <!-- ملخص سريع -->
                    <div class="card quick-summary">
                        <h2><i class="fas fa-tachometer-alt"></i> ملخص سريع</h2>
                        <div class="summary-items">
                            <div class="summary-item">
                                <span class="summary-label">المصروفات هذا الشهر</span>
                                <span class="summary-value" id="month-expense">0 ج.م</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">الإيرادات هذا الشهر</span>
                                <span class="summary-value" id="month-income">0 ج.م</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">الأقساط المستحقة</span>
                                <span class="summary-value" id="due-installments">0 ج.م</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">الديون المستحقة</span>
                                <span class="summary-value" id="due-debts">0 ج.م</span>
                            </div>
                        </div>
                    </div>

                    <!-- المعاملات الأخيرة -->
                    <div class="card recent-transactions">
                        <div class="card-header">
                            <h2><i class="fas fa-history"></i> آخر المعاملات</h2>
                            <button class="btn btn-small" id="view-all-transactions">عرض الكل</button>
                        </div>
                        <div class="transactions-list" id="recent-transactions-list">
                            <!-- سيتم ملؤها بالجافاسكريبت -->
                            <p class="empty-message">مافيش معاملات مسجلة. اضف معاملة جديدة!</p>
                        </div>
                    </div>

                    <!-- الأهداف -->
                    <div class="card goals-preview">
                        <div class="card-header">
                            <h2><i class="fas fa-bullseye"></i> أهدافك</h2>
                            <button class="btn btn-small" id="add-goal-btn">إضافة هدف</button>
                        </div>
                        <div class="goals-list" id="goals-preview-list">
                            <!-- سيتم ملؤها بالجافاسكريبت -->
                            <p class="empty-message">مافيش أهداف. ابدأ بإضافة أول هدف!</p>
                        </div>
                    </div>

                    <!-- تذكيرات -->
                    <div class="card reminders">
                        <h2><i class="fas fa-bell"></i> التذكيرات</h2>
                        <div class="reminders-list" id="reminders-list">
                            <!-- سيتم ملؤها بالجافاسكريبت -->
                            <p class="empty-message">مافيش تذكيرات حالياً</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- المعاملات -->
            <section id="transactions" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <h2><i class="fas fa-exchange-alt"></i> إدارة المعاملات</h2>
                        <div class="action-buttons">
                            <button class="btn btn-primary" id="add-transaction-btn2">
                                <i class="fas fa-plus"></i> إضافة معاملة
                            </button>
                            <div class="filter-controls">
                                <select id="filter-type">
                                    <option value="all">كل الأنواع</option>
                                    <option value="income">إيرادات</option>
                                    <option value="expense">مصروفات</option>
                                </select>
                                <input type="date" id="filter-date">
                                <button class="btn btn-small" id="apply-filter">تطبيق</button>
                                <button class="btn btn-small" id="reset-filter">إعادة تعيين</button>
                            </div>
                        </div>
                    </div>
                    <div class="transactions-table-container">
                        <table class="transactions-table">
                            <thead>
                                <tr>
                                    <th>التاريخ</th>
                                    <th>الوصف</th>
                                    <th>النوع</th>
                                    <th>الفئة</th>
                                    <th>المبلغ</th>
                                    <th>الإجراءات</th>
                                </tr>
                            </thead>
                            <tbody id="transactions-table-body">
                                <!-- سيتم ملؤها بالجافاسكريبت -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- الميزانية -->
            <section id="budget" class="tab-content">
                <div class="budget-section">
                    <div class="card budget-categories">
                        <h2><i class="fas fa-list"></i> فئات الميزانية</h2>
                        <div class="categories-list" id="budget-categories-list">
                            <!-- سيتم ملؤها بالجافاسكريبت -->
                        </div>
                        <button class="btn btn-secondary" id="add-category-btn">
                            <i class="fas fa-plus"></i> إضافة فئة
                        </button>
                    </div>
                    <div class="card budget-summary">
                        <h2><i class="fas fa-chart-pie"></i> ملخص الميزانية</h2>
                        <div class="chart-container">
                            <canvas id="budget-chart"></canvas>
                        </div>
                        <div class="budget-stats">
                            <div class="budget-stat">
                                <span>إجمالي الميزانية</span>
                                <span id="total-budget">0 ج.م</span>
                            </div>
                            <div class="budget-stat">
                                <span>المصروف الفعلي</span>
                                <span id="actual-spending">0 ج.م</span>
                            </div>
                            <div class="budget-stat">
                                <span>المتبقي</span>
                                <span id="remaining-budget">0 ج.م</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- الديون والاقساط -->
            <section id="debts" class="tab-content">
                <div class="debts-section">
                    <div class="card debts-list">
                        <div class="card-header">
                            <h2><i class="fas fa-hand-holding-usd"></i> الديون والاقساط</h2>
                            <div class="action-buttons">
                                <button class="btn btn-primary" id="add-debt-btn">
                                    <i class="fas fa-plus"></i> إضافة دين/قسط
                                </button>
                                <select id="debt-type-filter">
                                    <option value="all">الكل</option>
                                    <option value="debt">ديون</option>
                                    <option value="installment">أقساط</option>
                                </select>
                            </div>
                        </div>
                        <div class="debts-table-container">
                            <table class="debts-table">
                                <thead>
                                    <tr>
                                        <th>الاسم</th>
                                        <th>النوع</th>
                                        <th>المبلغ الإجمالي</th>
                                        <th>المسدد</th>
                                        <th>المتبقي</th>
                                        <th>تاريخ الاستحقاق</th>
                                        <th>الحالة</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody id="debts-table-body">
                                    <!-- سيتم ملؤها بالجافاسكريبت -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="card upcoming-payments">
                        <h2><i class="fas fa-calendar-day"></i> المدفوعات القادمة</h2>
                        <div class="payments-list" id="upcoming-payments-list">
                            <!-- سيتم ملؤها بالجافاسكريبت -->
                            <p class="empty-message">مافيش دفعات قادمة</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- الأهداف -->
            <section id="goals" class="tab-content">
                <div class="goals-section">
                    <div class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-bullseye"></i> أهدافك المالية</h2>
                            <button class="btn btn-primary" id="add-goal-btn2">
                                <i class="fas fa-plus"></i> إضافة هدف جديد
                            </button>
                        </div>
                        <div class="goals-container" id="goals-container">
                            <!-- سيتم ملؤها بالجافاسكريبت -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- الاستثمارات -->
            <section id="investments" class="tab-content">
                <div class="investments-section">
                    <div class="card">
                        <div class="card-header">
                            <h2><i class="fas fa-chart-line"></i> إدارة الاستثمارات</h2>
                            <button class="btn btn-primary" id="add-investment-btn">
                                <i class="fas fa-plus"></i> إضافة استثمار
                            </button>
                        </div>
                        <div class="investments-container" id="investments-container">
                            <!-- سيتم ملؤها بالجافاسكريبت -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- التقارير -->
            <section id="reports" class="tab-content">
                <div class="reports-section">
                    <div class="card">
                        <h2><i class="fas fa-chart-pie"></i> تقارير مالية</h2>
                        <div class="report-controls">
                            <div class="date-range">
                                <label>الفترة الزمنية:</label>
                                <select id="report-period">
                                    <option value="month">هذا الشهر</option>
                                    <option value="last-month">الشهر الماضي</option>
                                    <option value="year">هذه السنة</option>
                                    <option value="custom">مخصص</option>
                                </select>
                                <div id="custom-date-range" class="hidden">
                                    <input type="date" id="report-start-date">
                                    <span>إلى</span>
                                    <input type="date" id="report-end-date">
                                </div>
                            </div>
                            <button class="btn btn-primary" id="generate-report">توليد التقرير</button>
                        </div>
                        
                        <div class="report-results">
                            <div class="chart-row">
                                <div class="chart-container">
                                    <canvas id="income-expense-chart"></canvas>
                                </div>
                                <div class="chart-container">
                                    <canvas id="category-chart"></canvas>
                                </div>
                            </div>
                            
                            <div class="report-summary">
                                <h3>ملخص التقرير</h3>
                                <div class="summary-grid" id="report-summary-grid">
                                    <!-- سيتم ملؤها بالجافاسكريبت -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- تذييل الصفحة -->
        <footer class="footer">
            <p>برنامج ميزانتي - لإدارة أمورك المالية بكل سهولة © <span id="current-year"></span></p>
            <div class="footer-links">
                <a href="#" id="export-data"><i class="fas fa-download"></i> تصدير البيانات</a>
                <a href="#" id="import-data"><i class="fas fa-upload"></i> استيراد البيانات</a>
                <a href="#" id="backup-data"><i class="fas fa-save"></i> نسخ احتياطي</a>
            </div>
        </footer>
    </div>

    <!-- النوافذ المنبثقة -->
    
    <!-- نافذة إضافة/تعديل معاملة -->
    <div class="modal" id="transaction-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="transaction-modal-title">إضافة معاملة جديدة</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="transaction-form">
                    <div class="form-group">
                        <label for="transaction-type">نوع المعاملة</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="type" value="income" checked>
                                <span class="radio-custom income">إيراد</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="type" value="expense">
                                <span class="radio-custom expense">مصروف</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="transaction-amount">المبلغ (ج.م)</label>
                        <input type="number" id="transaction-amount" step="0.01" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="transaction-description">الوصف</label>
                        <input type="text" id="transaction-description" placeholder="مثال: مرتب الشهر" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="transaction-category">الفئة</label>
                        <select id="transaction-category" required>
                            <option value="">اختر فئة</option>
                            <!-- سيتم ملؤها بالجافاسكريبت -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="transaction-date">التاريخ</label>
                        <input type="date" id="transaction-date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="transaction-notes">ملاحظات (اختياري)</label>
                        <textarea id="transaction-notes" rows="3" placeholder="أي ملاحظات إضافية"></textarea>
                    </div>
                    
                    <input type="hidden" id="transaction-id">
                    
                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary close-modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">حفظ المعاملة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نافذة إضافة/تعديل دين/قسط -->
    <div class="modal" id="debt-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="debt-modal-title">إضافة دين/قسط جديد</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="debt-form">
                    <div class="form-group">
                        <label for="debt-name">الاسم/الوصف</label>
                        <input type="text" id="debt-name" placeholder="مثال: قسط السيارة، دين شخصي" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="debt-type">النوع</label>
                        <select id="debt-type" required>
                            <option value="installment">قسط</option>
                            <option value="debt">دين</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="debt-total-amount">المبلغ الإجمالي (ج.م)</label>
                        <input type="number" id="debt-total-amount" step="0.01" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="debt-paid-amount">المبلغ المدفوع (ج.م)</label>
                        <input type="number" id="debt-paid-amount" step="0.01" min="0" value="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="debt-due-date">تاريخ الاستحقاق</label>
                        <input type="date" id="debt-due-date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="debt-installment-amount">قيمة القسط الشهري (ج.م)</label>
                        <input type="number" id="debt-installment-amount" step="0.01" min="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="debt-notes">ملاحظات (اختياري)</label>
                        <textarea id="debt-notes" rows="3" placeholder="مثال: تليفون 0123456789"></textarea>
                    </div>
                    
                    <input type="hidden" id="debt-id">
                    
                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary close-modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">حفظ</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نافذة إضافة/تعديل هدف -->
    <div class="modal" id="goal-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="goal-modal-title">إضافة هدف جديد</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="goal-form">
                    <div class="form-group">
                        <label for="goal-name">اسم الهدف</label>
                        <input type="text" id="goal-name" placeholder="مثال: شراء سيارة، تجهيز شقة" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-target-amount">المبلغ المستهدف (ج.م)</label>
                        <input type="number" id="goal-target-amount" step="0.01" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-saved-amount">المبلغ المدخر (ج.م)</label>
                        <input type="number" id="goal-saved-amount" step="0.01" min="0" value="0">
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-deadline">الموعد النهائي</label>
                        <input type="date" id="goal-deadline" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-priority">الأولوية</label>
                        <select id="goal-priority">
                            <option value="low">منخفضة</option>
                            <option value="medium" selected>متوسطة</option>
                            <option value="high">عالية</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="goal-notes">ملاحظات (اختياري)</label>
                        <textarea id="goal-notes" rows="3" placeholder="تفاصيل إضافية عن الهدف"></textarea>
                    </div>
                    
                    <input type="hidden" id="goal-id">
                    
                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary close-modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">حفظ الهدف</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
<!-- أضف في الـ header بعد زر إضافة المعاملة -->
<button onclick="setupCloudSync()" style="margin-right: 10px;">
    <i class="fas fa-cloud"></i> مزامنة
</button>
    <!-- نافذة إضافة/تعديل استثمار -->
    <div class="modal" id="investment-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="investment-modal-title">إضافة استثمار جديد</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="investment-form">
                    <div class="form-group">
                        <label for="investment-name">اسم الاستثمار</label>
                        <input type="text" id="investment-name" placeholder="مثال: أسهم، عقار، وديعة بنكية" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="investment-type">نوع الاستثمار</label>
                        <select id="investment-type">
                            <option value="stocks">أسهم</option>
                            <option value="real-estate">عقار</option>
                            <option value="bank-deposit">وديعة بنكية</option>
                            <option value="gold">ذهب</option>
                            <option value="other">أخرى</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="investment-amount">قيمة الاستثمار (ج.م)</label>
                        <input type="number" id="investment-amount" step="0.01" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="investment-date">تاريخ البدء</label>
                        <input type="date" id="investment-date" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="investment-return">العائد المتوقع (%)</label>
                        <input type="number" id="investment-return" step="0.01" min="0" value="5">
                    </div>
                    
                    <div class="form-group">
                        <label for="investment-notes">ملاحظات (اختياري)</label>
                        <textarea id="investment-notes" rows="3" placeholder="تفاصيل إضافية عن الاستثمار"></textarea>
                    </div>
                    
                    <input type="hidden" id="investment-id">
                    
                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary close-modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">حفظ الاستثمار</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- نافذة إضافة فئة -->
    <div class="modal" id="category-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>إضافة فئة جديدة</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="category-form">
                    <div class="form-group">
                        <label for="category-name">اسم الفئة</label>
                        <input type="text" id="category-name" placeholder="مثال: مواصلات، ترفيه" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="category-type">نوع الفئة</label>
                        <select id="category-type" required>
                            <option value="expense">مصروف</option>
                            <option value="income">إيراد</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="category-budget">ميزانية الفئة (ج.م) - شهرياً</label>
                        <input type="number" id="category-budget" step="0.01" min="0" placeholder="اتركه صفراً إذا كان غير محدد">
                    </div>
                    
                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary close-modal">إلغاء</button>
                        <button type="submit" class="btn btn-primary">حفظ الفئة</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="data.js"></script>
    <script src="utils.js"></script>
    <script src="script.js"></script>
<div id="sync-modal" class="modal">
    <div class="modal-content">
        <h3>المزامنة السحابية</h3>
        <p>ادخل GitHub Personal Access Token:</p>
        <input type="password" id="github-token" placeholder="ghp_xxxxxxxxxxxx" style="width: 100%; padding: 10px; margin: 10px 0;">
        <p style="font-size: 12px; color: #666;">
            <a href="https://github.com/settings/tokens/new" target="_blank">
                أنشئ Token جديد من هنا
            </a>
        </p>
        <button onclick="saveToken()" class="btn btn-primary">حفظ</button>
        <button onclick="closeModal()" class="btn">إلغاء</button>
    </div>
</div>

<script>
// وظائف المزامنة
function setupCloudSync() {
    document.getElementById('sync-modal').classList.add('active');
}

function saveToken() {
    const token = document.getElementById('github-token').value;
    if (token) {
        localStorage.setItem('github_token', token);
        alert('تم حفظ التوكن! البيانات راح تتحفظ على سحابة GitHub.');
        closeModal();
    }
}

function closeModal() {
    document.getElementById('sync-modal').classList.remove('active');
}

// مزامنة تلقائية كل 5 دقائق
setInterval(async () => {
    const data = {
        transactions: app.transactions,
        debts: app.debts,
        goals: app.goals
    };
    await saveToCloud(data);
}, 5 * 60 * 1000); // 5 دقائق
<script src="auto-sync.js"></script>
</body>
</html>